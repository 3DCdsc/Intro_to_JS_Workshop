<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel = "stylesheet" href = "./styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learning Site</title>
</head>
<body onload="onLoadHandler()">
  <div class="Viewframe">
    <div id="demo" class="Modal">  
      <img src='./assets/logo/logo_small.png'/>
      <h1 id="heading">Normal Cats</h1>
      <p>The <span class="animal">cat</span> is a domestic species of small carnivorous mammal. It is the only domesticated species in the family Felidae and is often referred to as the domestic <span class="animal">cat</span> to distinguish it from the wild members of the family. A <span class="animal">cat</span> can either be a house <span class="animal">cat</span>, a farm <span class="animal">cat</span> or a feral <span class="animal">cat</span>; the latter ranges freely and avoids human contact. Domestic <span class="animal">cat</span> are valued by humans for companionship and their ability to hunt rodents. About 60 <span class="animal">cat</span> breeds are recognized by various <span class="animal">cat</span> registries. <a href="http://en.wikipedia.org/wiki/Cat">Read more on Wikipedia</a>.</p>
      <div id="pictureDiv">
      <img id="cat" src="https://www.kasandbox.org/programming-images/animals/cat.png" height="150" alt="Cat">
      </div>
      <div id="Progress_Status"> 
        <div id="myprogressBar"></div> 
      </div>
      <button onclick="startDownloadDelay()">Start Download</button>
      <input id="CountdownTiming" type="number"/>
        <div id="Countdown"> </div>
      <button onclick="startCountDown()">Start countdown</button> 
      <button onclick="getData()">AJAX Loading</button>
      </div>
  </div>  
  
<script>
/* 
1. Find the DOM node using an access method.
2. Manipulate the DOM node by changing its attributes, styles, inner HTML, or appending new nodes to it.
*/
 var mouseOver = false;
 var divFirst = false;
 var extra = null;
 var image = document.getElementById('cat');
 image.style.transformOrigin = "left top";
 image.style.transition = ".5s all";

 
 function imageHoverHandler(e){
    if(!mouseOver){
      e.target.style.transform= "scale(2)"
    }
    else{
      e.target.style.transform= "scale(1)"
    }
    mouseOver = !mouseOver
    
 }

 function enlarge(e){
  if(!divFirst){
    e.target.style.transform= "scale(2)"
  }
  alert("imgFirst");
  
 }

 function bubblingCapture(e){
  divFirst = true;
  alert("divFirst");
 }

 image.addEventListener('click',enlarge,true);
 document.getElementById('pictureDiv').style.transition = ".5s all";
 document.getElementById('pictureDiv').addEventListener('click',bubblingCapture,true);
 
 image.addEventListener('mouseover',imageHoverHandler);
 image.addEventListener('mouseout',imageHoverHandler);
 image.onload = function(){
     console.log("loaded")
 }

 function update() { 
  var element = document.getElementById("myprogressBar");    
  var width = 1; 
  var identity = setInterval(scene, 10); 
  function scene() { 
    if (width >= 100) { 
      clearInterval(identity); 
    } else { 
      width++;  
      element.style.width = width + '%';  
    } 
  } 
  }

  function startDownloadDelay(){
    setTimeout(update,5000);
  } 

  function startCountDown() { 
  var element = document.getElementById("Countdown");   
  var timing  = document.getElementById("CountdownTiming").value;
  element.innerHTML = timing;
  var identity = setInterval(scene, 1000);
  function scene() { 
    if (timing <= 0) { 
      element.innerHTML = "ended"
      clearInterval(identity); 
    } else { 
      timing--;  
      element.innerHTML = timing
    } 
  } 
  }

  function onLoadHandler(){
    loadJson("https://api.thecatapi.com/v1/images/search").then((response)=>image.src = response[0]["url"]);
  }

  function loadJson(url) {
  return fetch(url)
    .then(response => {
      if (response.status == 200) {
        return response.json();
      } else {
        throw new HttpError(response);
      }
    })
  }

  function loadDoc() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
     document.getElementById("demo").innerHTML = this.responseText;
    }
  };
  xhttp.open("GET", "ajax_info.txt", true);
  xhttp.send();
  }

  function getData(){
    function firebaseData(){
      loadJson("https://intro-to-js-52753.firebaseio.com/test.json?auth=FxJ8eRhZBI8ST5OhrfLzvJSKn9YLXE8wLqS3NMfQ").then((response)=>{
      document.getElementById("demo").innerHTML = "<div class =\"Title\">" + response["Title"] + "<div class=\"Subtitle\">" + response["SubText"] + "</div></div>" ;
    })
    }
    setInterval(firebaseData,5000);
  }
</script>
</body>
</html>

